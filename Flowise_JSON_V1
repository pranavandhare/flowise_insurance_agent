{
  "nodes": [
    {
      "id": "startAgentflow_0",
      "type": "agentFlow",
      "position": {
        "x": -621.9391496105009,
        "y": 101.01395947979003
      },
      "data": {
        "id": "startAgentflow_0",
        "label": "Start",
        "version": 1.1,
        "name": "startAgentflow",
        "type": "Start",
        "color": "#7EE787",
        "hideInput": true,
        "baseClasses": [
          "Start"
        ],
        "category": "Agent Flows",
        "description": "Starting point of the agentflow",
        "inputParams": [
          {
            "label": "Input Type",
            "name": "startInputType",
            "type": "options",
            "options": [
              {
                "label": "Chat Input",
                "name": "chatInput",
                "description": "Start the conversation with chat input"
              },
              {
                "label": "Form Input",
                "name": "formInput",
                "description": "Start the workflow with form inputs"
              }
            ],
            "default": "chatInput",
            "id": "startAgentflow_0-input-startInputType-options",
            "display": true
          },
          {
            "label": "Form Title",
            "name": "formTitle",
            "type": "string",
            "placeholder": "Please Fill Out The Form",
            "show": {
              "startInputType": "formInput"
            },
            "id": "startAgentflow_0-input-formTitle-string",
            "display": true
          },
          {
            "label": "Form Description",
            "name": "formDescription",
            "type": "string",
            "placeholder": "Complete all fields below to continue",
            "show": {
              "startInputType": "formInput"
            },
            "id": "startAgentflow_0-input-formDescription-string",
            "display": true
          },
          {
            "label": "Form Input Types",
            "name": "formInputTypes",
            "description": "Specify the type of form input",
            "type": "array",
            "show": {
              "startInputType": "formInput"
            },
            "array": [
              {
                "label": "Type",
                "name": "type",
                "type": "options",
                "options": [
                  {
                    "label": "String",
                    "name": "string"
                  },
                  {
                    "label": "Number",
                    "name": "number"
                  },
                  {
                    "label": "Boolean",
                    "name": "boolean"
                  },
                  {
                    "label": "Options",
                    "name": "options"
                  }
                ],
                "default": "string"
              },
              {
                "label": "Label",
                "name": "label",
                "type": "string",
                "placeholder": "Label for the input"
              },
              {
                "label": "Variable Name",
                "name": "name",
                "type": "string",
                "placeholder": "Variable name for the input (must be camel case)",
                "description": "Variable name must be camel case. For example: firstName, lastName, etc."
              },
              {
                "label": "Add Options",
                "name": "addOptions",
                "type": "array",
                "show": {
                  "formInputTypes[$index].type": "options"
                },
                "array": [
                  {
                    "label": "Option",
                    "name": "option",
                    "type": "string"
                  }
                ]
              }
            ],
            "id": "startAgentflow_0-input-formInputTypes-array",
            "display": true
          },
          {
            "label": "Ephemeral Memory",
            "name": "startEphemeralMemory",
            "type": "boolean",
            "description": "Start fresh for every execution without past chat history",
            "optional": true,
            "id": "startAgentflow_0-input-startEphemeralMemory-boolean",
            "display": true
          },
          {
            "label": "Flow State",
            "name": "startState",
            "description": "Runtime state during the execution of the workflow",
            "type": "array",
            "optional": true,
            "array": [
              {
                "label": "Key",
                "name": "key",
                "type": "string",
                "placeholder": "Foo"
              },
              {
                "label": "Value",
                "name": "value",
                "type": "string",
                "placeholder": "Bar",
                "optional": true
              }
            ],
            "id": "startAgentflow_0-input-startState-array",
            "display": true
          },
          {
            "label": "Persist State",
            "name": "startPersistState",
            "type": "boolean",
            "description": "Persist the state in the same session",
            "optional": true,
            "id": "startAgentflow_0-input-startPersistState-boolean",
            "display": true
          }
        ],
        "inputAnchors": [],
        "inputs": {
          "startInputType": "formInput",
          "formTitle": "Customer Document Analysis",
          "formDescription": "Complete all fields below to continue",
          "formInputTypes": [
            {
              "type": "number",
              "label": "Customer ID",
              "name": "customer_id",
              "addOptions": ""
            }
          ],
          "startEphemeralMemory": "",
          "startState": "",
          "startPersistState": ""
        },
        "outputAnchors": [
          {
            "id": "startAgentflow_0-output-startAgentflow",
            "label": "Start",
            "name": "startAgentflow"
          }
        ],
        "outputs": {},
        "selected": false
      },
      "width": 104,
      "height": 66,
      "selected": false,
      "positionAbsolute": {
        "x": -621.9391496105009,
        "y": 101.01395947979003
      },
      "dragging": false
    },
    {
      "id": "httpAgentflow_0",
      "position": {
        "x": -470.43914961050086,
        "y": 100.26395947979003
      },
      "data": {
        "id": "httpAgentflow_0",
        "label": "http_0",
        "version": 1.1,
        "name": "httpAgentflow",
        "type": "HTTP",
        "color": "#FF7F7F",
        "baseClasses": [
          "HTTP"
        ],
        "category": "Agent Flows",
        "description": "Send a HTTP request",
        "inputParams": [
          {
            "label": "HTTP Credential",
            "name": "credential",
            "type": "credential",
            "credentialNames": [
              "httpBasicAuth",
              "httpBearerToken",
              "httpApiKey"
            ],
            "optional": true,
            "id": "httpAgentflow_0-input-credential-credential",
            "display": true
          },
          {
            "label": "Method",
            "name": "method",
            "type": "options",
            "options": [
              {
                "label": "GET",
                "name": "GET"
              },
              {
                "label": "POST",
                "name": "POST"
              },
              {
                "label": "PUT",
                "name": "PUT"
              },
              {
                "label": "DELETE",
                "name": "DELETE"
              },
              {
                "label": "PATCH",
                "name": "PATCH"
              }
            ],
            "default": "GET",
            "id": "httpAgentflow_0-input-method-options",
            "display": true
          },
          {
            "label": "URL",
            "name": "url",
            "type": "string",
            "id": "httpAgentflow_0-input-url-string",
            "display": true
          },
          {
            "label": "Headers",
            "name": "headers",
            "type": "array",
            "acceptVariable": true,
            "array": [
              {
                "label": "Key",
                "name": "key",
                "type": "string",
                "default": ""
              },
              {
                "label": "Value",
                "name": "value",
                "type": "string",
                "default": "",
                "acceptVariable": true
              }
            ],
            "optional": true,
            "id": "httpAgentflow_0-input-headers-array",
            "display": true
          },
          {
            "label": "Query Params",
            "name": "queryParams",
            "type": "array",
            "acceptVariable": true,
            "array": [
              {
                "label": "Key",
                "name": "key",
                "type": "string",
                "default": ""
              },
              {
                "label": "Value",
                "name": "value",
                "type": "string",
                "default": "",
                "acceptVariable": true
              }
            ],
            "optional": true,
            "id": "httpAgentflow_0-input-queryParams-array",
            "display": true
          },
          {
            "label": "Body Type",
            "name": "bodyType",
            "type": "options",
            "options": [
              {
                "label": "JSON",
                "name": "json"
              },
              {
                "label": "Raw",
                "name": "raw"
              },
              {
                "label": "Form Data",
                "name": "formData"
              },
              {
                "label": "x-www-form-urlencoded",
                "name": "xWwwFormUrlencoded"
              }
            ],
            "optional": true,
            "id": "httpAgentflow_0-input-bodyType-options",
            "display": true
          },
          {
            "label": "Body",
            "name": "body",
            "type": "string",
            "acceptVariable": true,
            "rows": 4,
            "show": {
              "bodyType": [
                "raw",
                "json"
              ]
            },
            "optional": true,
            "id": "httpAgentflow_0-input-body-string",
            "display": false
          },
          {
            "label": "Body",
            "name": "body",
            "type": "array",
            "acceptVariable": true,
            "show": {
              "bodyType": [
                "xWwwFormUrlencoded",
                "formData"
              ]
            },
            "array": [
              {
                "label": "Key",
                "name": "key",
                "type": "string",
                "default": ""
              },
              {
                "label": "Value",
                "name": "value",
                "type": "string",
                "default": "",
                "acceptVariable": true
              }
            ],
            "optional": true,
            "id": "httpAgentflow_0-input-body-array",
            "display": false
          },
          {
            "label": "Response Type",
            "name": "responseType",
            "type": "options",
            "options": [
              {
                "label": "JSON",
                "name": "json"
              },
              {
                "label": "Text",
                "name": "text"
              },
              {
                "label": "Array Buffer",
                "name": "arraybuffer"
              },
              {
                "label": "Raw (Base64)",
                "name": "base64"
              }
            ],
            "optional": true,
            "id": "httpAgentflow_0-input-responseType-options",
            "display": true
          }
        ],
        "inputAnchors": [],
        "inputs": {
          "method": "GET",
          "url": "https://nznobqxdsdxaqmocqouv.supabase.co/rest/v1/customer_documents",
          "headers": [],
          "queryParams": [
            {
              "key": "select",
              "value": "<p>*</p>"
            }
          ],
          "bodyType": "",
          "responseType": "json",
          "undefined": ""
        },
        "outputAnchors": [
          {
            "id": "httpAgentflow_0-output-httpAgentflow",
            "label": "HTTP",
            "name": "httpAgentflow"
          }
        ],
        "outputs": {},
        "selected": false
      },
      "type": "agentFlow",
      "width": 113,
      "height": 66,
      "selected": false,
      "dragging": false,
      "positionAbsolute": {
        "x": -470.43914961050086,
        "y": 100.26395947979003
      }
    },
    {
      "id": "directReplyAgentflow_0",
      "position": {
        "x": -62.68914961050086,
        "y": 94.63895947979003
      },
      "data": {
        "id": "directReplyAgentflow_0",
        "label": "Direct Reply 0",
        "version": 1,
        "name": "directReplyAgentflow",
        "type": "DirectReply",
        "color": "#4DDBBB",
        "hideOutput": true,
        "baseClasses": [
          "DirectReply"
        ],
        "category": "Agent Flows",
        "description": "Directly reply to the user with a message",
        "inputParams": [
          {
            "label": "Message",
            "name": "directReplyMessage",
            "type": "string",
            "rows": 4,
            "acceptVariable": true,
            "id": "directReplyAgentflow_0-input-directReplyMessage-string",
            "display": true
          }
        ],
        "inputAnchors": [],
        "inputs": {
          "directReplyMessage": "<p><span class=\"variable\" data-type=\"mention\" data-id=\"customFunctionAgentflow_0\" data-label=\"customFunctionAgentflow_0\">{{ customFunctionAgentflow_0 }}</span></p>",
          "undefined": ""
        },
        "outputAnchors": [],
        "outputs": {},
        "selected": false
      },
      "type": "agentFlow",
      "width": 163,
      "height": 66,
      "positionAbsolute": {
        "x": -62.68914961050086,
        "y": 94.63895947979003
      },
      "selected": false,
      "dragging": false
    },
    {
      "id": "customFunctionAgentflow_0",
      "position": {
        "x": -305.56414961050086,
        "y": 96.32645947979003
      },
      "data": {
        "id": "customFunctionAgentflow_0",
        "label": "custom_function_1",
        "version": 1,
        "name": "customFunctionAgentflow",
        "type": "CustomFunction",
        "color": "#E4B7FF",
        "baseClasses": [
          "CustomFunction"
        ],
        "category": "Agent Flows",
        "description": "Execute custom function",
        "inputParams": [
          {
            "label": "Input Variables",
            "name": "customFunctionInputVariables",
            "description": "Input variables can be used in the function with prefix $. For example: $foo",
            "type": "array",
            "optional": true,
            "acceptVariable": true,
            "array": [
              {
                "label": "Variable Name",
                "name": "variableName",
                "type": "string"
              },
              {
                "label": "Variable Value",
                "name": "variableValue",
                "type": "string",
                "acceptVariable": true
              }
            ],
            "id": "customFunctionAgentflow_0-input-customFunctionInputVariables-array",
            "display": true
          },
          {
            "label": "Javascript Function",
            "name": "customFunctionJavascriptFunction",
            "type": "code",
            "codeExample": "/*\n* You can use any libraries imported in Flowise\n* You can use properties specified in Input Variables with the prefix $. For example: $foo\n* You can get default flow config: $flow.sessionId, $flow.chatId, $flow.chatflowId, $flow.input, $flow.state\n* You can get global variables: $vars.<variable-name>\n* Must return a string value at the end of function\n*/\n\nconst fetch = require('node-fetch');\nconst url = 'https://api.open-meteo.com/v1/forecast?latitude=52.52&longitude=13.41&current_weather=true';\nconst options = {\n    method: 'GET',\n    headers: {\n        'Content-Type': 'application/json'\n    }\n};\ntry {\n    const response = await fetch(url, options);\n    const text = await response.text();\n    return text;\n} catch (error) {\n    console.error(error);\n    return '';\n}",
            "description": "The function to execute. Must return a string or an object that can be converted to a string.",
            "id": "customFunctionAgentflow_0-input-customFunctionJavascriptFunction-code",
            "display": true
          },
          {
            "label": "Update Flow State",
            "name": "customFunctionUpdateState",
            "description": "Update runtime state during the execution of the workflow",
            "type": "array",
            "optional": true,
            "acceptVariable": true,
            "array": [
              {
                "label": "Key",
                "name": "key",
                "type": "asyncOptions",
                "loadMethod": "listRuntimeStateKeys",
                "freeSolo": true
              },
              {
                "label": "Value",
                "name": "value",
                "type": "string",
                "acceptVariable": true,
                "acceptNodeOutputAsVariable": true
              }
            ],
            "id": "customFunctionAgentflow_0-input-customFunctionUpdateState-array",
            "display": true
          }
        ],
        "inputAnchors": [],
        "inputs": {
          "customFunctionInputVariables": [
            {
              "variableName": "httpData",
              "variableValue": "<p><span class=\"variable\" data-type=\"mention\" data-id=\"httpAgentflow_0\" data-label=\"httpAgentflow_0\">{{ httpAgentflow_0 }}</span> </p>"
            },
            {
              "variableName": "customerId",
              "variableValue": "<p><span class=\"variable\" data-type=\"mention\" data-id=\"$form.customer_id\" data-label=\"$form.customer_id\">{{ $form.customer_id }}</span> </p>"
            }
          ],
          "customFunctionJavascriptFunction": "// The httpResponse is a JSON STRING, so parse it first\nconst httpResponse = $httpData;\nconst customerIdInput = parseInt($customerId);\n\n// Parse the JSON string to get the array\nconst allDocuments = JSON.parse(httpResponse);\n\n// Filter documents for this customer only\nconst filteredDocuments = allDocuments.filter(doc => doc.customer_id === customerIdInput);\n\n// Format output nicely\nconst summary = {\n  customer_name: filteredDocuments[0]?.customer_name || \"Unknown\",\n  total_documents: filteredDocuments.length,\n  documents: filteredDocuments.map(doc => ({\n    type: doc.document_type,\n    file_name: doc.file_name,\n    uploaded: doc.uploaded_at\n  }))\n};\n\n// Return as string\nreturn JSON.stringify(summary, null, 2);\n",
          "customFunctionUpdateState": ""
        },
        "outputAnchors": [
          {
            "id": "customFunctionAgentflow_0-output-customFunctionAgentflow",
            "label": "Custom Function",
            "name": "customFunctionAgentflow"
          }
        ],
        "outputs": {},
        "selected": false
      },
      "type": "agentFlow",
      "width": 191,
      "height": 66,
      "selected": false,
      "positionAbsolute": {
        "x": -305.56414961050086,
        "y": 96.32645947979003
      },
      "dragging": false
    }
  ],
  "edges": [
    {
      "source": "startAgentflow_0",
      "sourceHandle": "startAgentflow_0-output-startAgentflow",
      "target": "httpAgentflow_0",
      "targetHandle": "httpAgentflow_0",
      "data": {
        "sourceColor": "#7EE787",
        "targetColor": "#FF7F7F",
        "isHumanInput": false
      },
      "type": "agentFlow",
      "id": "startAgentflow_0-startAgentflow_0-output-startAgentflow-httpAgentflow_0-httpAgentflow_0"
    },
    {
      "source": "httpAgentflow_0",
      "sourceHandle": "httpAgentflow_0-output-httpAgentflow",
      "target": "customFunctionAgentflow_0",
      "targetHandle": "customFunctionAgentflow_0",
      "data": {
        "sourceColor": "#FF7F7F",
        "targetColor": "#E4B7FF",
        "isHumanInput": false
      },
      "type": "agentFlow",
      "id": "httpAgentflow_0-httpAgentflow_0-output-httpAgentflow-customFunctionAgentflow_0-customFunctionAgentflow_0"
    },
    {
      "source": "customFunctionAgentflow_0",
      "sourceHandle": "customFunctionAgentflow_0-output-customFunctionAgentflow",
      "target": "directReplyAgentflow_0",
      "targetHandle": "directReplyAgentflow_0",
      "data": {
        "sourceColor": "#E4B7FF",
        "targetColor": "#4DDBBB",
        "isHumanInput": false
      },
      "type": "agentFlow",
      "id": "customFunctionAgentflow_0-customFunctionAgentflow_0-output-customFunctionAgentflow-directReplyAgentflow_0-directReplyAgentflow_0"
    }
  ]
}
